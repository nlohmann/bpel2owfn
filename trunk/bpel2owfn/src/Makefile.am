############################################################################
# Copyright 2005, 2006 Niels Lohmann, Christian Gierds, Dennis Reinert     #
#                                                                          #
# This file is part of BPEL2oWFN.                                          #
#                                                                          #
# BPEL2oWFN is free software; you can redistribute it and/or modify it     #
# under the terms of the GNU General Public License as published by the    #
# Free Software Foundation; either version 2 of the License, or (at your   #
# option) any later version.                                               #
#                                                                          #
# BPEL2oWFN is distributed in the hope that it will be useful, but WITHOUT #
# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or    #
# FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for #
# more details.                                                            #
#                                                                          #
# You should have received a copy of the GNU General Public License along  #
# with BPEL2oWFN; if not, write to the Free Software Foundation, Inc., 51  #
# Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.                     #
############################################################################

# File last changed $Date: 2006/11/24 14:52:46 $ by $Author: gierds $.
# Version $Revision: 1.45 $

bin_PROGRAMS = bpel2owfn preprocess

# flags for the compilers
AM_CXXFLAGS= -O2
AM_CFLAGS=   -O2

# define flags for Kimwitu++
KCFLAGS = --yystype --file-prefix=ast-system- --suffix=cc

# generated Flex and Bison sources
YYSOURCES = parser.h parser.cc lexer.cc

# everything about the Kimwitu++ sources
KCDUMMY = ast-system-dummy.cc
KCFILES = ast-to-petrinet-full1.k ast-to-petrinet-full2.k \
	  ast-to-petrinet-new1.k ast-to-petrinet-new2.k \
	  ast-to-petrinet-small.k ast-to-xml.k ast-to-cfg.k \
	  ast-grammar.k ast-config.k ast-postprocess.k ast-rewrite.k
KCGENERATED = ast-system-csgiok ast-system-k ast-system-rk ast-system-unpk
KCSOURCES = $(KCGENERATED:=.cc) \
	    $(KCGENERATED:=.h) \
	    $(KCFILES:.k=.cc) \
	    $(KCFILES:.k=.h) \
	    ast-system-yystype.h
KCOBJECTS = $(KCFILES:.k=.o) \
	    $(KCGENERATED:=.o)


# dependencies of the Kimwitu++ files
$(KCDUMMY): $(KCFILES)
	touch $@
	$(KC) $(KCFLAGS) $^
	$(MAKE) parser.o
	$(MAKE) $(KCOBJECTS)

$(KCOBJECTS): $(KCFILES)


# the list of sources
bpel2owfn_SOURCES = $(KCDUMMY)\
		    $(KCSOURCES)\
		    $(KCFILES)\
		    parser.yy parser.h\
		    lexer.ll\
		    bpel2owfn.cc\
		    debug.cc debug.h\
		    helpers.cc helpers.h\
		    petrinet.h\
		    petrinet.cc petrinet-output.cc petrinet-reduction.cc\
		    cfg.cc cfg.h\
		    options.cc options.h\
		    getopt.h getopt.c getopt1.c\
		    ast-tools.cc ast-tools.h\
		    ast-details.cc ast-details.h

preprocess_SOURCES = preprocess.cc


# when cleaning, also delete Vi's temp files
CLEANFILES = *~ bpel2owfn.exe.stackdump

# always clean the files generated by Kimwitu++, Flex and Bison
MAINTAINERCLEANFILES = $(YYGENERATED) \
		       $(KCSOURCES) \
		       $(YYSOURCES) \
		       $(KCDUMMY)
